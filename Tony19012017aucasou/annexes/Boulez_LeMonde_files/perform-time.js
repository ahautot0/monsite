define(function(require){var namespace={};var resourceAnalyzeNames={};var isMonitoring=true;if(!("performance"in window))namespace.analyzeEntries=function(){};else{var getEntries=performance.getEntriesByType||performance.webkitGetEntriesByType||performance.msGetEntriesByType||performance.mozGetEntriesByType||null;if(!getEntries)namespace.analyzeEntries=function(){}}var analyzeEntries=function(search,callback){if(typeof search!=="string"&&!(search instanceof RegExp))throw"Please enter a regex or a string in analyzeEntries function";
var res=[];var perfEntries=getEntries.call(performance,"resource");for(var i=0,max=perfEntries.length;i<max;i++){var name=perfEntries[i].name;if(encodeURI(search)===name||name.match(search)!=null)if(!(name in resourceAnalyzeNames)){res.push(perfEntries[i]);resourceAnalyzeNames[name]=true}}if(res.length===0)return false;setTimeout(function(){callback(res)},0);return true};namespace.analyzeEntries=namespace.analyzeEntries||analyzeEntries;namespace.startMonitoringEntries=function(search,callback,interval){if(!interval)interval=
1E3;isMonitoring=true;addEvent(document,"DOMContentLoaded",function(){namespace.analyzeEntries(search,callback)});addEvent(window,"load",function(){namespace.analyzeEntries(search,callback);setTimeout(function me(){if(!isMonitoring)return false;namespace.analyzeEntries(search,callback);setTimeout(me,interval)},interval)})};namespace.stopResourceMonitoring=function(){isMonitoring=false};namespace.getOrMonitorEntries=function(search,callback,interval){if(!!search)return false;if(namespace.analyzeEntries(search,
callback)===true)return true;else return namespace.startMonitoringEntries(search,callback,interval)};var iNumberOfTries=0,iDelay=500,iMaxTries=10,bIsFeatureSupported=true;if("externalHost"in window)bIsFeatureSupported=false;namespace.getFirstPaintTime=function getFirstPaintTime(callback){if(bIsFeatureSupported===false)return false;if("chrome"in window&&"loadTimes"in chrome){var firstPaintTime=chrome.loadTimes().firstPaintTime;firstPaintTime=Math.round(firstPaintTime*1E3)}else if("performance"in window&&
"timing"in performance&&"msFirstPaint"in performance.timing)var firstPaintTime=performance.timing.msFirstPaint;else bIsFeatureSupported=false;if(bIsFeatureSupported===true){firstPaintTime-=performance.timing.navigationStart;if(firstPaintTime>0){if(firstPaintTime>6E5)return false;setTimeout(function(){callback(firstPaintTime)},0)}else if(iMaxTries>iNumberOfTries)setTimeout(function(){iNumberOfTries++;getFirstPaintTime(callback)},iDelay)}};var addEvent=function(el,ev,fn){if(el.addEventListener)el.addEventListener(ev,
fn,false)};return namespace});
