define(function(require){var $=require("jquery");var PT=require("lmd/core/webperf/perform-time");var timers={};function trackTime(params){var defaults={category:"Global",subcategory:"",timing:0,label:"-",probability:10,once:true};params=$.extend(defaults,params);if(/trackTimeDebug/.test(document.location.search)===true)params.probability=100;if(!params.timing&&"performance"in window&&"now"in performance){if("mark"in performance)performance.mark(params.category+" - "+params.subcategory);params.timing=
performance.now()}if(params.timing>36E5)return false;if(!params.category||!params.subcategory)throw'mandatory parameters : "category" and "subcategory"';if(params.once&&params.category+params.subcategory+params.label in timers)return false;timers[params.category+params.subcategory+params.label]=true;params.timing=Math.round(params.timing);if(params.timing){if("console"in window)console.debug("timings",params.category,params.subcategory,params.timing);if(Math.random()*100>params.probability)return true;
if("ga"in window&&params.timing)if(params.label)ga("send","timing",params.category,params.subcategory,params.timing,params.label);else ga("send","timing",params.category,params.subcategory,params.timing);if("_gaq"in window&&params.timing)_gaq.push(["_trackTiming",params.category,params.subcategory,params.timing,params.label,100])}}PT.getFirstPaintTime(function(time){trackTime({category:"Page Load",subcategory:"First Paint",timing:time,probability:10})});return{trackTime:trackTime}});
